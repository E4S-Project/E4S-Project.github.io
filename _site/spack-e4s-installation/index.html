<h2 id="manual-installation-instructions">Manual Installation Instructions</h2>

<p>The instructions on this page provide specific guidance for using Spack to install E4S.  See <a href="/use-spack-installation/">Finding and installing products using Spack</a> for general Spack instruction on how to install individual E4S-related products.</p>

<h3 id="instructions">Instructions</h3>

<p>Clone Spack, checkout the appropriate release branch, if desired, and source the Spack <code class="language-plaintext highlighter-rouge">setup-env.sh</code> script.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$&gt; git clone https://github.com/spack/spack
$&gt; (cd spack &amp;&amp; git checkout e4s-25.06)
$&gt; . spack/share/spack/setup-env.sh
</code></pre></div></div>

<p>Configure Spack to know where the E4S Build Cache is located. You can use either a release specific build cache, or the mixed build cache. The release specific build cache contains only binaries from the particular release, whereas the mixed build cache contains binaries from all releases and from in between releases.</p>

<p>Release-specific:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$&gt; spack mirror add E4S https://cache.e4s.io/25.06
$&gt; spack buildcache keys -it
</code></pre></div></div>

<p>Obtain a copy of the E4S Model Environment for the E4S release you are interested in, and rename it to <code class="language-plaintext highlighter-rouge">spack.yaml</code>, if needed. These are found in the <a href="https://github.com/E4S-Project/e4s/tree/master/environments">E4S Environment Repository</a>. For this example, we will use the <a href="https://github.com/E4S-Project/e4s/tree/master/environments/25.06/amd64-gcc-cuda-ubuntu22.04">E4S 25.06 Model Environment for X86_64 Systems with NVIDIA GPUs</a>.</p>

<p>Tweak the model environment so that it suits your needs: remove packages you arenâ€™t interested in, select the correct GPU variants, specify the microarchitecture target and compiler selections, as needed. Once modified, you can concretize the environment, which you should do from the same directory that contains your environment.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$&gt; time spack -e . concretize -f | tee concretize.log
</code></pre></div></div>

<p>Start the install, specifying <code class="language-plaintext highlighter-rouge">-jN</code> where N reflects an appropriate degree of parallelism to use for the builds, as in <code class="language-plaintext highlighter-rouge">make -jN</code>.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$&gt; spack -e . install -jN
</code></pre></div></div>

<p>Build times can be quite a long time depending on the modifications you make to the environment and the capabilities of the machine you use for building. If you are using an E4S release branch of Spack, and using a minimally modified E4S release environment where the same compilers, operating system, and target architecture are retained, that will maximize your ability to pull pre-built packages from the build cache.</p>

<p>Please contact Sameer Shende at sameer [at] cs.uoregon.edu if you have any questions.</p>

<h3 id="references">References</h3>

<ul>
  <li><a href="https://spack.readthedocs.io/en/latest/">Spack General Documentation</a></li>
  <li><a href="https://spack.readthedocs.io/en/latest/environments.html">Spack Environments Documentation</a></li>
  <li><a href="https://spack.readthedocs.io/en/latest/binary_caches.html">Spack Build Cache Documentation</a></li>
  <li><a href="https://github.com/E4S-Project/e4s">E4S Model Environment Repository</a></li>
  <li><a href="https://github.com/E4S-Project/e4s/tree/master/environments/25.06">E4S 25.06 Model Environments</a></li>
  <li><a href="https://e4s.io">E4S Homepage</a></li>
</ul>
